#include <stdio.h>

#define DISK_SIZE 16

// 0 = free, 1 = allocated
int bitmap[DISK_SIZE] = {0};

// Allocate consecutive blocks
int bitmap_allocate(int size) {
    int count = 0;

    for (int i = 0; i < DISK_SIZE; i++) {
        if (bitmap[i] == 0) {
            count++;
            if (count == size) {
                // Mark blocks as allocated
                for (int j = i; j > i - size; j--) {
                    bitmap[j] = 1;
                }
                return i - size + 1; // start index
            }
        } else {
            count = 0;
        }
    }
    return -1; // allocation failed
}

// Free blocks
void bitmap_free(int start, int size) {
    for (int i = start; i < start + size; i++) {
        bitmap[i] = 0;
    }
}

// Print bitmap
void print_bitmap() {
    for (int i = 0; i < DISK_SIZE; i++) {
        printf("%d ", bitmap[i]);
    }
    printf("\n");
}

int main() {
    int start = bitmap_allocate(3);
    print_bitmap();

    bitmap_free(start, 3);
    print_bitmap();

    return 0;
}